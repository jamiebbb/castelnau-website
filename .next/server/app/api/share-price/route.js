"use strict";(()=>{var e={};e.id=617,e.ids=[617],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9213:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>v,originalPathname:()=>y,patchFetch:()=>E,requestAsyncStorage:()=>f,routeModule:()=>d,serverHooks:()=>g,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>w});var a={};t.r(a),t.d(a,{GET:()=>h});var n=t(5419),o=t(9108),i=t(9678),c=t(8070);let s="share_price_cache";async function p(){try{let e=await fetch("https://api.vercel.com/v1/edge-config",{headers:{Authorization:`Bearer ${process.env.VERCEL_ACCESS_TOKEN}`}});return(await e.json())[s]||null}catch(e){return console.error("Error fetching cache:",e),null}}async function u(e){try{await fetch("https://api.vercel.com/v1/edge-config",{method:"PATCH",headers:{Authorization:`Bearer ${process.env.VERCEL_ACCESS_TOKEN}`,"Content-Type":"application/json"},body:JSON.stringify({[s]:{price:e,timestamp:Date.now()}})})}catch(e){console.error("Error updating cache:",e)}}async function l(){try{let e=await fetch("https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=CTN.L&apikey=LKRB0RE577TSMDK0"),r=await e.json(),t=parseFloat(r["Global Quote"]["05. price"]);return isNaN(t)?null:t}catch(e){return console.error("Error fetching price:",e),null}}async function h(){try{let e=await p();if(e&&Date.now()-e.timestamp<864e5)return c.Z.json({price:e.price,cached:!0});let r=await l();if(null!==r)return await u(r),c.Z.json({price:r,cached:!1});if(e)return c.Z.json({price:e.price,cached:!0});return c.Z.json({error:"Unable to fetch share price"},{status:500})}catch(e){return console.error("API error:",e),c.Z.json({error:"Internal server error"},{status:500})}}let d=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/share-price/route",pathname:"/api/share-price",filename:"route",bundlePath:"app/api/share-price/route"},resolvedPagePath:"C:\\Users\\jamie\\OneDrive - Phoenix Asset Management Partners\\Castelnau Group\\Scraping\\Website\\castelnau-website\\src\\app\\api\\share-price\\route.ts",nextConfigOutput:"export",userland:a}),{requestAsyncStorage:f,staticGenerationAsyncStorage:m,serverHooks:g,headerHooks:v,staticGenerationBailout:w}=d,y="/api/share-price/route";function E(){return(0,i.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:m})}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[638,206],()=>t(9213));module.exports=a})();